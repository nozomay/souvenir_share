<h1>投稿詳細</h1>
<br>
  <% if flash[:notice] %>
    <div class="flash">
      <%= flash[:notice] %>
    </div>
  <% end %>
<br>
<p>投稿日時：<%= @post.created_at.strftime('%Y/%m/%d') %></p>
<% if @post.user == current_user %>
    <%= link_to "削除", post_path(@post), method: :delete %>
  <% end %>
<h2>画像</h2>
  <%= attachment_image_tag @post, :image %>
<h2>タイトル</h2>
<p><%= @post.title %></p>
<h2>レビュー</h2>
<p><%= @post.review %></p>
<!--レビュー星-->
<div id="star-rate-<%= @post.id %>"></div>
<script>
  $('#star-rate-<%= @post.id %>').raty({
    size:36,
    starOff: "<%= asset_path('star-off.png') %>",
    starOn: "<%= asset_path('star-on.png') %>",
    starHalf: "<%= asset_path('star-half.png') %>",
    half: true,
    readOnly: true,
    score: <%= @post.rate%>
  })
</script>
<p><%= @post.rate %></p>

</div>
<p><%= @post.address %></p>
<!--地図表示-->
<div id="map"></div>
<script>
  function initMap(){
  const test ={lat: <%= @post.latitude || 35.6809591 %>, lng: <%= @post.longitude || 139.7673068 %>};
  const map = new google.maps.Map(document.getElementById('map'), {
      zoom: 15,
      center: test
  });

  const transitLayer = new google.maps.TransitLayer();
  transitLayer.setMap(map);

  const contentString = '住所：<%= @post.address %>';
  const infowindow = new google.maps.InfoWindow({
      content: contentString
  });

  const marker = new google.maps.Marker({
      position:test,
      map: map,
      title: contentString
  });

  marker.addListener('click', function() {
      infowindow.open(map, marker);
  });
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap" async defer></script>